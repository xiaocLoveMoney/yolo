# 快速开始指南

## 正确的操作流程

### 1️⃣ 上传数据集（必须第一步）

访问 http://localhost:3000/datasets

1. 点击"选择 ZIP 文件"
2. 选择包含图片的 zip 文件
3. 点击"上传"
4. **重要**：上传成功后，点击"准备数据集"按钮
5. 等待准备完成，状态变为 `prepared`

### 2️⃣ 创建标注任务

访问 http://localhost:3000/annotate

1. 复制数据集页面中已准备好的数据集 ID（如 `ds_20260115_212121`）
2. 粘贴到"数据集ID"输入框
3. 输入类别（如 `person,car,dog`）
4. 点击"创建任务"

**⚠️ 常见错误**：
- 如果提示 "数据集中未找到图片目录"，说明没有执行 prepare 操作
- 必须先在数据集页面完成 prepare，再来标注页面创建任务

### 3️⃣ 标注图片

1. 在左侧图片列表中选择图片
2. 在画布上拖动鼠标绘制边界框
3. 右侧选择类别
4. 点击"保存"
5. 重复标注多张图片
6. 完成后点击"导出YOLO"

### 4️⃣ 训练模型

访问 http://localhost:3000/train

1. 输入已准备好的数据集 ID
2. 选择模型（建议首次测试用 YOLOv8n）
3. 设置参数（建议首次测试：epochs=2, batch=8）
4. 点击"开始训练"
5. 实时查看训练日志

### 5️⃣ 推理测试

访问 http://localhost:3000/infer

1. 点击"刷新模型"
2. 选择训练好的模型
3. 上传测试图片
4. 点击"开始推理"
5. 查看检测结果

## 数据集 ZIP 文件要求

### 方式一：YOLO 格式（推荐）

```
dataset.zip
├── images/
│   ├── train/
│   │   ├── img1.jpg
│   │   └── img2.jpg
│   └── val/
│       └── img3.jpg
└── labels/
    ├── train/
    │   ├── img1.txt
    │   └── img2.txt
    └── val/
        └── img3.txt
```

### 方式二：仅图片（需要标注）

```
dataset.zip
├── img1.jpg
├── img2.jpg
└── img3.jpg
```

上传后系统会自动创建 `images/` 目录。

## 故障排查

### 问题：创建标注任务失败

**错误信息**：`数据集 xxx 中未找到图片目录`

**解决方案**：
1. 回到数据集页面
2. 找到对应的数据集
3. 确认状态是 `prepared` 而不是 `uploaded`
4. 如果是 `uploaded`，点击该数据集的"准备数据集"按钮
5. 等待准备完成后再创建标注任务

### 问题：训练日志不显示

**解决方案**：
1. 检查浏览器控制台是否有 SSE 连接错误
2. 系统会自动降级到轮询模式
3. 刷新页面重试

### 问题：推理没有检测到目标

**原因**：
- 训练轮数太少（epochs < 10）
- 训练数据太少（< 50 张）
- 类别标注不准确

**建议**：
- 增加训练轮数（epochs=50-100）
- 增加训练数据量
- 确保标注质量

## 完整测试流程（5分钟）

```bash
# 1. 准备测试数据
# 创建一个包含 5-10 张图片的 zip 文件

# 2. 启动后端
cd backend
python run.py

# 3. 启动前端（新终端）
cd frontend
npm run dev

# 4. 浏览器操作
# http://localhost:3000/datasets -> 上传 + 准备
# http://localhost:3000/annotate -> 标注 2-3 张
# http://localhost:3000/train -> 训练（epochs=2 快速测试）
# http://localhost:3000/infer -> 推理测试
```

## 技术支持

如遇到其他问题，请查看：
1. 后端终端的错误日志
2. 前端浏览器控制台
3. `backend/data/jobs/` 目录下的训练日志文件
